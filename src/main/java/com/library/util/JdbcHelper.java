/**
 * 
 */
package com.library.util;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import org.apache.derby.jdbc.EmbeddedDriver;

/**
 * @author Daniel
 * 
 */
public class JdbcHelper {

	private static Connection getConnection() {
		Connection conn = null;
		try {
			Class.forName(EmbeddedDriver.class.getName());
			conn = DriverManager
					.getConnection(
							// "jdbc:derby:library;create=true", "root",
							// "root");
							"jdbc:derby:D:\\Workspaces\\research\\web-development\\library;create=true",
							"root", "root");
		} catch (ClassNotFoundException e) {
		} catch (SQLException e) {
		}
		return conn;
	}

	public static ResultSet execute(String sql, String... parameters)
			throws SQLException {
		System.out.println();
		System.out.println(sql);
		PreparedStatement stmt = getConnection().prepareStatement(sql);
		if (null != parameters) {
			for (int i = 0, size = parameters.length; i < size; i++) {
				String parameter = parameters[i];
				if (null != parameter && !parameter.trim().equals("")) {
					stmt.setString(i + 1, parameter);
					System.out.print(parameter + " ");
				}
			}
		}
		stmt.execute();
		return stmt.getResultSet();
	}

	public static void main(String[] args) throws SQLException {
		// String sql =
		// "CREATE TABLE book(id  BIGINT not null generated by default as identity,name varchar(50),price varchar(50),isbn varchar(40))";
		// String sql =
		// "INSERT INTO book VALUES(1,'Effective Java','30','3232543353')";
		// String sql =
		// "INSERT INTO book VALUES(2,'Thinking in Java','98','235454455')";
		String sql = "select * from book";
		ResultSet rs = execute(sql);
		if (null != rs) {
			while (rs.next()) {
				System.out.println(rs.getString(1) + " " + rs.getString(2));
			}
		}
	}
}
